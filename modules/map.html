<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GEO-TACTICAL GRID</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        body { overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        
        /* Контейнер карты */
        .map-container {
            position: relative;
            flex-grow: 1;
            background: #050505 url('https://upload.wikimedia.org/wikipedia/commons/e/ec/World_map_blank_without_borders.svg') no-repeat center center;
            background-size: contain;
            border: 1px solid #333;
            box-shadow: inset 0 0 50px #000;
            filter: invert(1) hue-rotate(180deg) contrast(1.5);
            overflow: hidden;
            transition: 1s filter;
        }

        /* Точки агентов */
        .dot {
            position: absolute; width: 10px; height: 10px;
            background: var(--alert-red); border-radius: 50%;
            cursor: pointer; box-shadow: 0 0 10px var(--alert-red);
            animation: pulse 1.5s infinite;
        }
        .dot::after {
            content: attr(data-info);
            position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%);
            background: #000; color: var(--term-green); padding: 5px;
            font-size: 10px; white-space: nowrap; border: 1px solid var(--term-green);
            display: none; z-index: 10;
        }
        .dot:hover::after { display: block; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 51, 51, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0); }
        }

        /* Самолетики (для химтрейлов) */
        .plane {
            position: absolute; font-size: 20px; color: #fff;
            transition: transform 5s linear;
        }
        .trail {
            position: absolute; height: 2px; background: rgba(255,255,255,0.5);
            transform-origin: left center; pointer-events: none;
        }

        /* Панель управления */
        .control-panel {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; padding: 20px;
            background: #020202; border-top: 1px solid #333;
            height: 80px;
        }
        
        .action-btn {
            background: #111; border: 1px solid #333; color: #888; padding: 10px;
            cursor: pointer; text-transform: uppercase; font-family: inherit; transition: 0.3s;
            font-size: 11px; font-weight: bold;
        }
        .action-btn:hover { border-color: var(--alert-red); color: var(--alert-red); }
        .action-btn:active { transform: scale(0.95); }

    </style>
</head>
<body>
    <div style="padding: 10px; border-bottom: 1px solid #333;">
        <h2 style="margin: 0; font-size: 18px;">GLOBAL CONFLICT MONITOR</h2>
        <div id="log-display" style="color: var(--term-green); font-size: 12px; margin-top: 5px;">STATUS: MONITORING...</div>
    </div>
    
    <div class="map-container" id="map">
        <div class="dot" style="top: 35%; left: 22%;" data-info="AGENT ORANGE (USA)"></div>
        <div class="dot" style="top: 25%; left: 55%;" data-info="AGENT VODKA (RUSSIA)"></div>
        <div class="dot" style="top: 85%; left: 50%;" data-info="BASE 7 (ANTARCTICA)"></div>
        <div class="dot" style="top: 40%; left: 75%;" data-info="ASSET: WINNIE (CHINA)"></div>
        <div class="dot" style="top: 60%; left: 30%;" data-info="TEST SITE (BRAZIL)"></div>
    </div>

    <div class="control-panel">
        <button class="action-btn" onclick="deployChemtrails()">DEPLOY CHEMTRAILS</button>
        <button class="action-btn" onclick="resetWeather()">CLEAR SKIES</button>
        <button class="action-btn" onclick="killInternet()">KILL INTERNET</button>
        <button class="action-btn" onclick="triggerPandemic()" style="border-color: var(--alert-red); color: var(--alert-red)">!!! PANDEMIC 2.0 !!!</button>
    </div>

    <script src="../assets/js/main.js"></script>
    <script>
        const map = document.getElementById('map');
        const log = document.getElementById('log-display');

        function logMsg(msg) {
            log.innerHTML = `> ${msg}`;
            soundType();
        }

        // 1. ХИМТРЕЙЛЫ
        function deployChemtrails() {
            logMsg("DISPERSING ALUMINUM PARTICLES...");
            soundClick();
            
            for(let i=0; i<5; i++) {
                spawnPlane();
            }
        }

        function spawnPlane() {
            const plane = document.createElement('div');
            plane.innerText = "✈";
            plane.className = "plane";
            
            // Старт (случайная точка слева)
            const startY = Math.random() * 80 + 10;
            plane.style.left = "-50px";
            plane.style.top = startY + "%";
            
            map.appendChild(plane);

            // Анимация полета
            // Используем setTimeout чтобы CSS transition сработал
            setTimeout(() => {
                plane.style.transform = `translateX(${window.innerWidth + 100}px)`;
                
                // Рисуем след (полосу)
                const trail = document.createElement('div');
                trail.className = 'trail';
                trail.style.top = (startY + 1) + "%";
                trail.style.left = "0";
                trail.style.width = "0%";
                map.appendChild(trail);

                // След растет вместе с самолетом
                trail.style.transition = "width 5s linear";
                setTimeout(() => trail.style.width = "100%", 100);
                
                // Удаление
                setTimeout(() => { plane.remove(); trail.remove(); }, 6000);
            }, 100);
        }

        // 2. СБРОС
        function resetWeather() {
            logMsg("WEATHER CONTROL: RESETTING TO DEFAULT...");
            document.querySelectorAll('.plane, .trail').forEach(el => el.remove());
            map.style.filter = "invert(1) hue-rotate(180deg) contrast(1.5)";
        }

        // 3. KILL INTERNET
        function killInternet() {
            logMsg("SHUTTING DOWN DNS ROOT SERVERS...");
            map.style.filter = "grayscale(100%) brightness(0.1)";
            
            const warning = document.createElement('div');
            warning.innerText = "CONNECTION LOST";
            warning.style.cssText = "position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: red; font-size: 40px; border: 5px solid red; padding: 20px; font-weight: bold; transform: rotate(-10deg);";
            warning.id = "offline-msg";
            map.appendChild(warning);
            
            soundDeny();
        }

        // 4. ПАНДЕМИЯ
        function triggerPandemic() {
            logMsg("RELEASING PATHOGEN IN MAJOR CITIES...");
            document.querySelectorAll('.dot').forEach(dot => {
                dot.style.transform = "scale(5)";
                dot.style.background = "yellow";
                dot.style.boxShadow = "0 0 50px yellow";
                dot.style.transition = "1s";
            });
            
            setTimeout(() => {
                logMsg("ERROR: POPULATION IMMUNITY TOO HIGH. DEPLOYING 5G BOOST...");
            }, 2000);
        }
    </script>
</body>
</html>